# file: playbooks/Sandbox/Ephemeral_Runner.yml
# playbook: Ephemeral Runner
# version: 0.8.1
# description:
#     Run in Container
---
### 02_Managed_Region_Before_Content ORCHESTRATION ARCHITECT REGION ###

# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK 30_managed_block_before_content
# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK 30_managed_block_before_content
## Generated from playbook specifications metadata field 'pre_run_playbooks'
- ansible.builtin.import_playbook: "../Meta/Setup_Environment.yml"
# END ORCHESTRATION ARCHITECT MANAGED BLOCK 30_managed_block_before_content
# END ORCHESTRATION ARCHITECT MANAGED BLOCK 30_managed_block_before_content

### 03_Content_Region ORCHESTRATION ARCHITECT REGION ###

# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK 50_content_region_message
# END ORCHESTRATION ARCHITECT MANAGED BLOCK 50_content_region_message

- name: "Ephemeral Runner Playbook Sanity Tests"
  hosts: localhost
  connection: local
  roles:
    - role: qemu_runtime
      qemu_runtime_name: Sandbox_QEMU_Machine
      qemu_runtime_target: test_target
      qemu_runtime_state: info
    - role: nspawn_runtime
      nspawn_runtime_name: Sandbox_NSPAWN_Machine
      nspawn_runtime_target: test_target_2
      nspawn_runtime_state: info
    - role: container
      container:
        nspawn_runtime:
          name: Sandbox_Container_Nspawn_Machine
          
- name: Ephemeral NSPAWN
  hosts: localhost
  connection: local
  roles:
    - role: nspawn_runtime
      vars:
        nspawn_runtime_target: "/"
        nspawn_runtime_name: "EphemeralHost"
        nspawn_runtime_overlays: ["/etc::/etc", "/root::/root"]
        nspawn_runtime_extras: ["--user=root", "/bin/zsh"]
        nspawn_runtime_state: present

- name: Ephemeral QEMU
  hosts: localhost
  connection: local
  roles:
    - role: qemu_runtime
      vars:
        qemu_runtime:
          device_path: "/"
          name: "QEMU_Ephemeral_Demo"


### 04_Managed_Region_After_Content ORCHESTRATION ARCHITECT REGION ###

# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK 90_managed_block_after_content
# END ORCHESTRATION ARCHITECT MANAGED BLOCK 90_managed_block_after_content
