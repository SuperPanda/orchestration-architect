{# 00_Template_Header ORCHESTRATION ARCHITECT REGION #}
{# BEGIN ORCHESTRATION ARCHITECT FRAGMENT 00_template_file_header #}
{# fragment: roles/meta_playbook/templates/fragments/00_template_file_header.j2 #}
{#
 # file: roles/meta_playbook/templates/playbooks/base.yml.j2
 # skeleton file: roles/meta_playbook/templates/playbooks/base.yml.j2.skel
 # version: 0.8.0
 # generatation timestamp (UTC): 20240709T190826Z
 #
 # WARNING: Auto-Generated From Skeleton File
 #          ALL CHANGES WILL BE LOST!
 #          In order to customize this template, update the skeleton
 #          file to customize the file. To modify included fragments
 #          update the corresponding fragment file. To add/remove
 #          fragments or regions, update the template specification.
 #
 #}
{# END ORCHESTRATION ARCHITECT FRAGMENT 00_template_file_header #}
{# BEGIN ORCHESTRATION ARCHITECT FRAGMENT 10_template_vars #}
{# fragment: roles/meta_playbook/templates/fragments/10_template_vars.j2 #}
{% set collection_metadata = collection_metadata %}
{% set playbook_spec = specification %}
{% set playbook_name = playbook_name %}
{% set playbook_path = playbook_path %}
{% set playbook_description = specification.description %}
{% set metadata = metadata %}
{% set playbook_metadata = specification.metadata %}
{% if specification.playbook_tasks is not defined %}
  {%- set playbook_tasks = [{ 'name': "Placeholder Task Name"}] %}
{% else %}
  {%- set playbook_tasks = specification.playbook_tasks %}
{% endif %}
{% if specification.metadata is not defined %}
  {%- set playbook_metadata = {} %}
{% else %}
  {%- set playbook_metadata = specification.metadata %}
{% endif %}
{% set pre_run_playbooks = playbook_metadata.get('pre_run_playbooks', []) %}
{% set post_run_playbooks = playbook_metadata.get('post_run_playbooks', []) %}
{# END ORCHESTRATION ARCHITECT FRAGMENT 10_template_vars #}
{# BEGIN ORCHESTRATION ARCHITECT FRAGMENT 11_common_template_macros #}
{# fragment: roles/meta_playbook/templates/fragments/11_common_template_macros.j2 #}
{%- macro trigger_role_task(task) %}
      ansible.builtin.include_role:
        name: {{ task.trigger_role.name }}
      vars:
{% for key, value in task.trigger_role.items() %}
{% if key != 'name' %}
        {{ task.trigger_role.name}}_{{ key }}: {{ value }}
{% endif %}
{% endfor %}
{%- endmacro %}

{%- macro placeholder_task() %}
      ansible.builtin.debug:
        msg: "Placeholder task executed."
{%- endmacro %}

{%- macro render_task(task) %}
- name: {{ task.name }}
{% if task.get('trigger_role',false) %}
{{- trigger_role_task(task) }}
{% else %}
{{- placeholder_task() }}
{% endif %}
{%- endmacro %}

{# END ORCHESTRATION ARCHITECT FRAGMENT 11_common_template_macros #}
{# 01_Header ORCHESTRATION ARCHITECT REGION #}
{# BEGIN ORCHESTRATION ARCHITECT FRAGMENT 20_file_header #}
{# fragment: roles/meta_playbook/templates/fragments/20_file_header.j2 #}
{% if playbook_spec.get('metadata',{}).get('auto_generated', false) %}
# =============================================
# AUTO-GENERATED FILE - DO NOT EDIT!
# This file is generated by an automated system.
# Any manual changes may be overwritten.
# =============================================
{% endif %}
# playbook: {{ playbook_name }}
# file: {{ playbook_path }}
# version: {{ metadata.version }}
{% if playbook_description is defined %}
# description: {{ playbook_description }}
{% endif %}
---
{# END ORCHESTRATION ARCHITECT FRAGMENT 20_file_header #}
{# 02_Managed_Region_Before_Content ORCHESTRATION ARCHITECT REGION #}
### 02_Managed_Region_Before_Content ORCHESTRATION ARCHITECT REGION ###

{# BEGIN ORCHESTRATION ARCHITECT FRAGMENT 30_managed_block_before_content #}
{# fragment: roles/meta_playbook/templates/fragments/30_managed_block_before_content.j2 #}
# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK 30_managed_block_before_content
# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK pre_run_playbooks 
{% if pre_run_playbooks %}
## Generated from playbook specifications metadata field 'pre_run_playbooks'
{% for playbook in pre_run_playbooks  %}
- ansible.builtin.import_playbook: "{{ playbook }}"
{% endfor %}
{% endif %}
# END ORCHESTRATION ARCHITECT MANAGED BLOCK pre_run_playbooks 
# END ORCHESTRATION ARCHITECT MANAGED BLOCK 30_managed_block_before_content
{# END ORCHESTRATION ARCHITECT FRAGMENT 30_managed_block_before_content #}

{# 03_Content_Region ORCHESTRATION ARCHITECT REGION #}
### 03_Content_Region ORCHESTRATION ARCHITECT REGION ###

{# BEGIN ORCHESTRATION ARCHITECT FRAGMENT 50_content_region_message #}
{# fragment: roles/meta_playbook/templates/fragments/50_content_region_message.j2 #}
# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK 50_content_region_message
{% if not playbook_spec.get('metadata',{}).get('auto_generated', false) %}
# NOTE: Manual changes should occur in this region, below the managed block
{% endif %}
# END ORCHESTRATION ARCHITECT MANAGED BLOCK 50_content_region_message
{# END ORCHESTRATION ARCHITECT FRAGMENT 50_content_region_message #}
{# (@customization_msg) Customize Skeleton Here #}

{# 04_Managed_Region_After_Content ORCHESTRATION ARCHITECT REGION #}
### 04_Managed_Region_After_Content ORCHESTRATION ARCHITECT REGION ###

{# BEGIN ORCHESTRATION ARCHITECT FRAGMENT 90_managed_block_after_content #}
{# fragment: roles/meta_playbook/templates/fragments/90_managed_block_after_content.j2 #}
# BEGIN ORCHESTRATION ARCHITECT MANAGED BLOCK 90_managed_block_after_content
# END ORCHESTRATION ARCHITECT MANAGED BLOCK 90_managed_block_after_content
{# END ORCHESTRATION ARCHITECT FRAGMENT 90_managed_block_after_content #}

